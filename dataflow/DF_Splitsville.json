{
	"name": "DF_Splitsville",
	"properties": {
		"type": "MappingDataFlow",
		"typeProperties": {
			"sources": [
				{
					"dataset": {
						"referenceName": "DS_CsvUpperMidwestCustomers",
						"type": "DatasetReference"
					},
					"name": "MidwestCustomers"
				}
			],
			"sinks": [
				{
					"dataset": {
						"referenceName": "DS_OutOther",
						"type": "DatasetReference"
					},
					"name": "sink2"
				},
				{
					"dataset": {
						"referenceName": "DS_OutOther",
						"type": "DatasetReference"
					},
					"name": "sink3"
				},
				{
					"dataset": {
						"referenceName": "DS_OutOther",
						"type": "DatasetReference"
					},
					"name": "sink4"
				},
				{
					"dataset": {
						"referenceName": "DS_OutOther",
						"type": "DatasetReference"
					},
					"name": "sink5"
				},
				{
					"dataset": {
						"referenceName": "DS_OutOther",
						"type": "DatasetReference"
					},
					"name": "sink6"
				},
				{
					"dataset": {
						"referenceName": "DS_OutOther",
						"type": "DatasetReference"
					},
					"name": "sink7"
				},
				{
					"dataset": {
						"referenceName": "DS_OutOther",
						"type": "DatasetReference"
					},
					"name": "sink8"
				},
				{
					"dataset": {
						"referenceName": "DS_OutOther",
						"type": "DatasetReference"
					},
					"name": "sink9"
				}
			],
			"transformations": [
				{
					"name": "split1"
				},
				{
					"name": "aggregate1"
				},
				{
					"name": "assert1"
				}
			],
			"scriptLines": [
				"source(output(",
				"          FirstName as string,",
				"          LastName as string,",
				"          Email as string,",
				"          Phone as string,",
				"          Address as string,",
				"          City as string,",
				"          State as string,",
				"          Zip as string",
				"     ),",
				"     allowSchemaDrift: true,",
				"     validateSchema: false,",
				"     ignoreNoFilesFound: false) ~> MidwestCustomers",
				"MidwestCustomers split(State == \"WI\",",
				"     State == \"MN\",",
				"     State == \"MI\",",
				"     State == \"IL\",",
				"     State == \"IN\",",
				"     State == \"IA\",",
				"     State == \"ND\",",
				"     State == \"SD\",",
				"     disjoint: false) ~> split1@(OutWi, OutMn, OutMI, OutIl, OutIn, OutIa, OutND, OutSD, OutOther)",
				"split1@OutOther aggregate(rowCount = count(FirstName)) ~> aggregate1",
				"aggregate1 assert(expectTrue(rowCount == 0, false, 'HasNoRecordsCheck', null, 'The data stream must be empty')) ~> assert1",
				"split1@OutWi sink(allowSchemaDrift: true,",
				"     validateSchema: false,",
				"     input(",
				"          TransactionID as string,",
				"          Date as string,",
				"          Name as string,",
				"          Email as string,",
				"          PolicyType as string,",
				"          PremiumAmount as string,",
				"          TransactionType as string,",
				"          Status as string",
				"     ),",
				"     partitionFileNames:['SplitWi.csv'],",
				"     skipDuplicateMapInputs: true,",
				"     skipDuplicateMapOutputs: true,",
				"     partitionBy('hash', 1)) ~> sink2",
				"split1@OutMn sink(allowSchemaDrift: true,",
				"     validateSchema: false,",
				"     input(",
				"          TransactionID as string,",
				"          Date as string,",
				"          Name as string,",
				"          Email as string,",
				"          PolicyType as string,",
				"          PremiumAmount as string,",
				"          TransactionType as string,",
				"          Status as string",
				"     ),",
				"     partitionFileNames:['SplitMn.csv'],",
				"     skipDuplicateMapInputs: true,",
				"     skipDuplicateMapOutputs: true,",
				"     partitionBy('hash', 1)) ~> sink3",
				"split1@OutMI sink(allowSchemaDrift: true,",
				"     validateSchema: false,",
				"     input(",
				"          TransactionID as string,",
				"          Date as string,",
				"          Name as string,",
				"          Email as string,",
				"          PolicyType as string,",
				"          PremiumAmount as string,",
				"          TransactionType as string,",
				"          Status as string",
				"     ),",
				"     partitionFileNames:['SplitMI.csv'],",
				"     skipDuplicateMapInputs: true,",
				"     skipDuplicateMapOutputs: true,",
				"     partitionBy('hash', 1)) ~> sink4",
				"split1@OutIl sink(allowSchemaDrift: true,",
				"     validateSchema: false,",
				"     input(",
				"          TransactionID as string,",
				"          Date as string,",
				"          Name as string,",
				"          Email as string,",
				"          PolicyType as string,",
				"          PremiumAmount as string,",
				"          TransactionType as string,",
				"          Status as string",
				"     ),",
				"     partitionFileNames:['SplitIl.csv'],",
				"     skipDuplicateMapInputs: true,",
				"     skipDuplicateMapOutputs: true,",
				"     partitionBy('hash', 1)) ~> sink5",
				"split1@OutIn sink(allowSchemaDrift: true,",
				"     validateSchema: false,",
				"     input(",
				"          TransactionID as string,",
				"          Date as string,",
				"          Name as string,",
				"          Email as string,",
				"          PolicyType as string,",
				"          PremiumAmount as string,",
				"          TransactionType as string,",
				"          Status as string",
				"     ),",
				"     partitionFileNames:['SplitIn.csv'],",
				"     skipDuplicateMapInputs: true,",
				"     skipDuplicateMapOutputs: true,",
				"     partitionBy('hash', 1)) ~> sink6",
				"split1@OutIa sink(allowSchemaDrift: true,",
				"     validateSchema: false,",
				"     input(",
				"          TransactionID as string,",
				"          Date as string,",
				"          Name as string,",
				"          Email as string,",
				"          PolicyType as string,",
				"          PremiumAmount as string,",
				"          TransactionType as string,",
				"          Status as string",
				"     ),",
				"     partitionFileNames:['SplitIa.csv'],",
				"     skipDuplicateMapInputs: true,",
				"     skipDuplicateMapOutputs: true,",
				"     partitionBy('hash', 1)) ~> sink7",
				"split1@OutND sink(allowSchemaDrift: true,",
				"     validateSchema: false,",
				"     input(",
				"          TransactionID as string,",
				"          Date as string,",
				"          Name as string,",
				"          Email as string,",
				"          PolicyType as string,",
				"          PremiumAmount as string,",
				"          TransactionType as string,",
				"          Status as string",
				"     ),",
				"     partitionFileNames:['SplitNd.csv'],",
				"     skipDuplicateMapInputs: true,",
				"     skipDuplicateMapOutputs: true,",
				"     partitionBy('hash', 1)) ~> sink8",
				"split1@OutSD sink(allowSchemaDrift: true,",
				"     validateSchema: false,",
				"     input(",
				"          TransactionID as string,",
				"          Date as string,",
				"          Name as string,",
				"          Email as string,",
				"          PolicyType as string,",
				"          PremiumAmount as string,",
				"          TransactionType as string,",
				"          Status as string",
				"     ),",
				"     partitionFileNames:['SplitSd.csv'],",
				"     skipDuplicateMapInputs: true,",
				"     skipDuplicateMapOutputs: true,",
				"     partitionBy('hash', 1)) ~> sink9"
			]
		}
	}
}